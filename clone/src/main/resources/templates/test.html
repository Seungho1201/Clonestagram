<!DOCTYPE html><html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Clonestagram</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
    <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>
</head>

<style>
    /* 모달 스타일 */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);

        align-items: center;
        justify-content: center ;
        animation: fadeIn 0.15s ease-out; /* 모달이 나타날 때 애니메이션 추가 */
    }

    .modal-content {
        width: 30%;
        background: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        position: relative;
    }


    .postModal{
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);

        align-items: center;
        justify-content: center ;
        animation: fadeIn 0.3s ease-out; /* 모달이 나타날 때 애니메이션 추가 */
    }

    .postModal-content{
        width: 70%;
        height: 675px;
        background: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        position: relative;
    }

    /* 모달이 등장할 때의 애니메이션 */
    @keyframes fadeIn {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }

</style>


<body class="bg-gray-50">

<header class="fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-50">
    <div class="max-w-8xl mx-auto px-4">
        <div class="flex items-center justify-between h-16">
            <div class="flex-shrink-0">

            </div>

            <div class="hidden md:block flex-1 max-w-md mx-8">
                <div class="relative">
                        <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
                            <i class="fas fa-search"></i>
                        </span>
                    <form method="GET"  action="/search" style="display: flex">
                        <input type="text" name="searchText" placeholder="Search" class="w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-gray-400"/>
                        <input type="submit" value="검색">
                    </form>

                </div>

            </div>


            <div class="flex items-center space-x-6">



            </div>
        </div>
    </div>
</header>

<main class="pt-20 pb-16 max-w-8xl mx-auto px-4 flex gap-12">
    <div class="hidden lg:flex flex-col fixed left-0 top-0 h-screen w-[244px] border-r border-gray-200 pt-20 px-3">
        <div class="flex flex-col space-y-6">
            <a href="/test" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="fas fa-home text-xl w-6"></i>
                <span class="ml-4">Home</span>
            </a>

            <a href="#" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="fas fa-search text-xl w-6"></i>
                <span class="ml-4">Search</span>
            </a>

            <a href="#" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="far fa-compass text-xl w-6"></i>
                <span class="ml-4">Explore</span>
            </a>

            <a href="#" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="far fa-play-circle text-xl w-6"></i><span class="ml-4">Reels</span>
            </a>

            <a href="#" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="far fa-paper-plane text-xl w-6"></i><span class="ml-4">Messages</span>
            </a>
            <a href="#" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="far fa-heart text-xl w-6"></i>
                <span class="ml-4">Notifications</span>
            </a>

            <a href="/post" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="far fa-plus-square text-xl w-6"></i>
                <span class="ml-4">Create</span>
            </a>

            <a href="/mypage" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <img src="https://placehold.co/80" alt="Story" class="rounded-full border-2 border-white"/>
                <span class="ml-4">Profile</span>
            </a>
        </div>
        <div class="mt-auto mb-6">
            <a href="#" class="flex items-center p-3 text-base hover:bg-gray-100 rounded-lg">
                <i class="fas fa-bars text-xl w-6"></i>
                <span class="ml-4">More</span>
            </a>
        </div>
    </div>

    <div class="flex-1 max-w-2xl mx-auto lg:ml-72">

        <!--스토리-->
        <div class="bg-white rounded-lg shadow mb-6 p-4 overflow-x-auto">
            <div class="flex space-x-4">

                <div class="flex flex-col items-center space-y-1 flex-shrink-0">

                    <div class="w-16 h-16 rounded-full p-0.5 bg-gradient-to-tr from-yellow-400 to-custom">
                        <img src="https://placehold.co/80" alt="Story" class="rounded-full border-2 border-white"/>
                    </div>
                    <span class="text-xs">Your Story</span>
                </div>

            </div>
        </div>

        <div class="space-y-6" th:each="post:${postData2}">
            <article class="bg-white rounded-lg shadow max-w-lg mx-auto">

                <!--프로필 이미지-->
                <div class="p-4 flex items-center">
                    <img src="https://placehold.co/80" alt="Profile" class="h-8 w-8 rounded-full mr-3"/>
                    <div class="flex-1">
                        <!--작성자 ID-->

                        <h3 class="font-semibold text-sm" th:text="${post.postUserId}">작성자 ID</h3>
                    </div>

                   <p th:if="${post.postUserId == userId }">
                       <a th:href="@{'/edit/' + ${post.postId}}">[수정]</a>
                   </p>

                    <p th:if="${post.postUserId == userId}">
                        <a href="#" th:onclick="|deletePost(${post.postId})|">[삭제]</a>
                    </p>

                    <!-- JavaScript 추가 -->
                    <script>
                        function deletePost(postId) {
                            if (confirm("정말 삭제하시겠습니까?")) {
                                fetch(`/delete/` + postId, {
                                    method: "DELETE"
                                }).then(response => {
                                    if (response.ok) {
                                        alert("삭제되었습니다.");
                                        window.location.href = "/test"; // 삭제 후 리다이렉트
                                    } else {
                                        alert("삭제 실패!");
                                    }
                                }).catch(error => console.error("Error:", error));
                            }
                        }
                    </script>



                    <button class="text-gray-700"  onclick="openModal()">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                </div>

                <!--게시글 이미지-->
                <div class="aspect-w-4 aspect-h-5">
                    <img src="https://placehold.co/400" alt="Post" class="w-full h-full object-cover"/>
                </div>

                <!--이미지 아래 버튼-->
                <div class="p-4">
                    <div class="flex items-center space-x-4 mb-4">
                        <!--Likes-->
                        <button class="text-2xl text-gray-700 hover:text-gray-900">
                            <i class="far fa-heart"></i>
                        </button>

                        <!--Comment-->
                        <button
                                class="text-2xl text-gray-700 hover:text-gray-900 testAjax"
                                th:data-post-id="${post.postId}"
                                onclick="openPostModal(this);">
                            <i class="far fa-comment"></i>
                        </button>


                        <!--DM-->
                        <button class="text-2xl text-gray-700 hover:text-gray-900">
                            <i class="far fa-paper-plane"></i>
                        </button>

                        <div class="flex-1"></div>

                        <!--Bookmark-->
                        <button class="text-2xl text-gray-700 hover:text-gray-900">
                            <i class="far fa-bookmark"></i>
                        </button>
                    </div>

                    <!--하단 내용-->
                    <div class="space-y-2">
                        <!--좋아요 수-->
                        <p class="font-semibold text-sm" th:text="${'좋아요 ' + post.postRecommend + '개'}">likes</p>
                        <p class="text-sm">
                            <!--작성자 ID-->
                            <span class="font-semibold" th:text="${post.postUserId}">작성자 ID</span>
                            <span th:text="${post.postContent}">게시글 내용</span>

                        </p>

                    </div>
                </div>
                <div class="p-4 border-t">
                    <div class="flex items-center">
                        <button class="text-xl text-gray-400 mr-4">
                            <i class="far fa-smile"></i>
                        </button>
                        <input type="text" placeholder="Add a comment..." class="flex-1 text-sm border-none focus:ring-0"/>
                        <button class="text-custom font-semibold text-sm ml-4">Post</button>
                    </div>
                </div>
            </article>
            <br>
        </div>
    </div>

    <!-- 우측 사이드바 -->
    <div class="hidden lg:block w-80 ml-12">
        <div class="fixed w-80">
            <div class="flex items-center space-x-4 mb-6">
                <img src="https://placehold.co/80" alt="Profile" class="h-12 w-12 rounded-full"/>
                <div>
                    <h3 class="font-semibold text-sm" th:text="${userName}">유저 이름</h3>
                    <p class="text-sm text-gray-500" th:text="${userId}">유저아이디</p>
                </div>

                <a href="/logout"> <button class="ml-auto text-custom text-sm font-semibold">Logout</button></a>

            </div>
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-semibold text-gray-500">Suggestions For You</h3>
                </div>

                <div class="space-y-4">
                    <div class="flex items-center">
                        <img src="https://placehold.co/80" alt="Suggestion" class="h-8 w-8 rounded-full mr-3"/>
                        <div class="flex-1">
                            <h4 class="text-sm font-semibold">추천유저 ID</h4>
                        </div>
                        <button class="text-custom text-xs font-semibold">Follow</button>
                    </div>
                </div>
            </div>
            <footer class="text-xs text-gray-400">
                <nav class="mb-4">
                    <ul class="flex flex-wrap gap-x-2">
                        <li><a href="https://creatie.ai/" class="hover:underline">Front from Creatie AI</a></li>
                    </ul>
                </nav>

                <p>© 2025 CLONESTAGRAM FROM GitHub : Seungho1201</p>
            </footer>
        </div>
    </div>
</main>

<nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200">
    <div class="flex justify-around py-3">
        <a href="#" class="text-xl text-gray-700"><i class="fas fa-home"></i></a>
        <a href="#" class="text-xl text-gray-700"><i class="fas fa-search"></i></a>
        <a href="#" class="text-xl text-gray-700"><i class="far fa-plus-square"></i></a>
        <a href="#" class="text-xl text-gray-700"><i class="far fa-play-circle"></i></a>
        <a href="#" class="text-xl text-gray-700">
            <img src="https://creatie.ai/ai/api/search-image?query=A professional headshot of a young person with a friendly smile, wearing casual attire, against a neutral background. The lighting is soft and natural, creating a welcoming and approachable appearance.&width=80&height=80&orientation=squarish&flag=0cb04414-97a3-4205-8392-f223e88e10a6&flag=03240ae7-b333-4716-8eb4-a26235b1b544&flag=3d055ec5-7e46-4769-8dee-16e0917d5e32" alt="Profile" class="h-6 w-6 rounded-full"/>
        </a>
    </div>
</nav>

<!-- 모달 -->
<div class="modal" id="modal">
    <div class="modal-content" style="text-align: center">

        <div style="height: 40px; padding-top: 10px;">
            <h4>신고</h4>
        </div>

        <hr>

        <div style="height: 40px; padding-top: 10px;">
            <h3>팔로우 취소</h3>
        </div>

        <div style="height: 40px; padding-top: 10px;">
            <h3>삭제</h3>
        </div>


        <hr>

        <div style="height: 40px; padding-top: 10px;">
            <h3>즐겨찾기에 추가</h3>
        </div>

        <hr>

        <div style="height: 40px; padding-top: 10px;">
            <h3>이 계정 정보</h3>
        </div>

        <hr>

        <div onclick="closeModal()" style="height: 40px; padding-top: 10px;">
            <h3>취소</h3>
        </div>
    </div>
</div>

<!-- 게시글 댓글 모달 -->
<div class="postModal" id="postModal">
    <div class="postModal-content" style="text-align: center; display: flex">

        <div style="padding: 20px">
            <img src="https://placehold.co/600"/>
            <br>
        </div>

        <div>
            <div onclick="closePostModal()" style="height: 40px; padding-top: 10px; display: flex">
                <img src="https://placehold.co/80" alt="Suggestion" class="h-8 w-8 rounded-full mr-3"/>
                <p id="postUserId"></p>   <!-- 작성자 -->
                <h3 style="margin-left: auto">X</h3>
            </div>

            <br>
            <hr>

            <div style="padding: 20px; width: 450px; height:470px; text-align: left">
                <p id="postContent"></p>  <!-- 내용 -->


                <div id="postImg"></div> <!-- 이미지 -->
            </div>

            <div style="margin-bottom: 0px">
                <div style="text-align: left">
                    <!--Likes-->
                    <button class="text-2xl text-gray-700 hover:text-gray-900" style="margin-right: 10px">
                        <i class="far fa-heart"></i>
                    </button>

                    <!--Comment-->
                    <button class="text-2xl text-gray-700 hover:text-gray-900 testAjax" style="margin-right: 10px"
                            >
                        <i class="far fa-comment"></i>
                    </button>

                    <!--DM-->
                    <button class="text-2xl text-gray-700 hover:text-gray-900">
                        <i class="far fa-paper-plane"></i>
                    </button>

                    <p id="postRecommend"></p>  <!-- 추천 수 -->
                    <p id="postDate"></p>    <!-- 날짜 -->
                </div>

            </div>

        </div>


    </div>


</div>



<script>
    // 모달 열기
    function openModal() {
        document.getElementById("modal").style.display = "flex";
    }
    // 모달 닫기
    function closeModal() {
        document.getElementById("modal").style.display = "none";
    }

    // 모달 열기
    function openPostModal(button) {

        // 버튼에서 data-post-id 값을 가져옴
        const postId = button.getAttribute("data-post-id");
        console.log(postId);
        setDetailData(postId)


        document.getElementById("postModal").style.display = "flex";

    }
    // 모달 닫기
    function closePostModal() {
        document.getElementById("postModal").style.display = "none";
    }

    function setDetailData(id){
        fetch(`/postDetail/${id}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error("서버 응답 실패");
                }
                return response.json();  // JSON 변환
            })
            .then(data => {
                console.log("받은 데이터:", data);

                // 각 요소를 찾아서 데이터 삽입
                document.getElementById('postContent').innerText = data.postContent;
                document.getElementById('postUserId').innerText = `${data.postUserId}`;
                document.getElementById('postRecommend').innerText = `${data.postRecommend}`;
                document.getElementById('postDate').innerText = `${data.postDate || "정보 없음"}`;

            })
            .catch(error => {
                console.error("에러 발생:", error);
            });
    }


</script>

